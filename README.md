这两个 Python 脚本的逻辑、作用和效果。

### `ssq_data_processor.py`

* **逻辑：** 该脚本的主要逻辑是从一个指定的网站（默认为 `https://www.17500.cn/chart/ssq-tjb.html`）抓取最新的双色球开奖数据。它使用 `requests` 库发送 HTTP 请求获取网页内容，然后使用 `BeautifulSoup` 库解析 HTML 结构，提取出期号、红球和蓝球数据。抓取到的最新数据会与本地已有的 CSV 文件（默认为 `shuangseqiu.csv`）中的数据进行比较，如果发现新的期号数据，则将新数据追加到 CSV 文件中，并按期号升序排列后保存，同时去除重复项。脚本还包含错误处理机制，例如尝试不同的编码读取 CSV 文件以及处理网络请求异常。
* **作用：** 这个脚本的作用是自动化地更新双色球历史开奖数据。它确保用于分析的数据集是尽可能最新的，为后续的分析提供了数据基础。
* **效果：** 运行该脚本可以保持本地双色球历史数据文件的实时性。如果网站上有新的开奖数据发布，运行此脚本将把这些新数据添加到您的数据集中，而不会丢失原有的历史数据。这使得依赖于历史数据的分析能够基于更全面的信息进行。

### `ssq_analyzer.py`

* **逻辑：** 该脚本是一个全面的双色球数据分析工具，它依赖于 `ssq_data_processor.py` 提供的历史数据。其主要逻辑流程如下：
    1.  **数据加载与预处理：** 从 CSV 文件（优先加载处理后的文件 `shuangseqiu_processed.csv`，如果不存在或加载失败则加载原始文件 `shuangseqiu.csv` 并进行清理、结构化和特征工程）加载数据。清理包括去除缺失值和确保数据类型正确。结构化包括将红球和蓝球数据分别提取，并添加红球位置列。特征工程会计算新的分析维度，如红球和、跨度、奇偶计数、区域计数、连续数字对、与上期的重复数，以及蓝球的奇偶、大小、质数状态等。
    2.  **历史统计与模式分析：** 对加载的全部历史数据进行统计分析，包括号码的总体频率、按位置的频率、当前遗漏、平均间隔，并识别热/冷号。同时，分析计算出的特征的分布模式，例如红球和的统计、最常见的奇偶比、区域分布模式等。还会进行关联规则挖掘，找出红球之间的频繁组合。
    3.  **ML 模型训练与趋势预测：** 使用历史数据（通过创建滞后特征）训练机器学习模型（默认为 RandomForestClassifier），旨在预测下一期的某些特征趋势，例如红球奇数数量和蓝球奇偶。
    4.  **号码评分：** 结合历史统计数据（频率、遗漏）和 ML 模型预测的趋势（如果可用，否则回退到历史模式），为每个红球和蓝球计算一个综合得分。评分考虑了频率排名、遗漏偏差以及与预测趋势的匹配度。
    5.  **组合生成与过滤：** 基于号码得分和预测的趋势，从得分较高的号码池中生成一定数量的潜在双色球号码组合。生成过程可能使用基于分数的概率采样。生成的组合会根据它们与预测趋势和历史模式的匹配度进行评分/排名，最终选择得分最高的组合作为推荐。
    6.  **回测：** 在历史数据上执行回测，通过模拟在过去每个时期进行预测和选号，并与实际开奖结果进行比较，评估模型的性能和选号策略的有效性。回测过程会记录每个组合的红球命中数和蓝球是否命中。
    7.  **最终推荐：** 使用全部历史数据进行分析、ML训练和预测，生成最终推荐的号码组合（单式或小复式）。
    8.  **7+7 复式选号：** 基于号码的总体得分，选择得分最高的 7 个红球和 7 个蓝球，提供一个 7+7 复式投注的建议号码范围。
    9.  **报告输出：** 将分析过程中的关键结果、回测摘要、最终推荐组合和 7+7 复式选号输出到一个文本报告文件中。脚本还可选地生成图表（如果 `SHOW_PLOTS` 为 True）。
* **作用：** 这个脚本的作用是利用历史数据进行统计分析、模式识别和机器学习预测，从而尝试找出双色球开奖号码的一些潜在规律或趋势，并基于这些分析结果生成推荐的号码组合。它提供了一种基于数据和算法的选号辅助工具。
* **效果：** 运行该脚本会输出一份详细的分析报告，其中包含历史数据的统计摘要、模式分析结果、回测结果以及最终推荐的号码组合。回测结果可以帮助评估当前分析方法的有效性（尽管彩票结果本质上是随机的，历史数据分析并不能保证未来的结果）。最终推荐的组合是基于脚本设定的各种分析维度和权重计算得出的，可以作为用户选号时的参考。7+7 复式选号则提供了一个相对宽泛的投注范围建议。

总的来说，`ssq_data_processor.py` 负责数据的基础工作（获取和更新），而 `ssq_analyzer.py` 是核心的分析和推荐引擎，它读取数据，应用统计和机器学习方法，并生成选号建议。
